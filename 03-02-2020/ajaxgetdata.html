<html>
 <head>
 <title>Using an Array of XMLHttpRequest Objects</title>
 <script language = "javascript">
 var index = 0;
 var XMLHttpRequestObjects = new Array();
 function getData1(dataSource, divID)
 {
 if (window.XMLHttpRequest) {
 XMLHttpRequestObjects.push(new XMLHttpRequest());
 } else if (window.ActiveXObject) {
 XMLHttpRequestObjects.push(new ActiveXObject("Microsoft.XMLHTTP"));
 }
 index = XMLHttpRequestObjects.length - 1;
 if(XMLHttpRequestObjects[index]) {
 XMLHttpRequestObjects[index].open("GET", dataSource);
 var obj = document.getElementById(divID);
 XMLHttpRequestObjects[index].onreadystatechange = function()
 {
 if (XMLHttpRequestObjects[index].readyState == 4 &&
 XMLHttpRequestObjects[index].status == 200) {
 obj.innerHTML = XMLHttpRequestObjects[index].responseText;
 }
 }
 XMLHttpRequestObjects[index].send(null);
 }
 }
 .
 .
 .
And getData2, the function tied to button 2, works in a similar fashion:
 function getData2(dataSource, divID)
 {
 if (window.XMLHttpRequest) {
 XMLHttpRequestObjects.push(new XMLHttpRequest());
114 Ajax: A Beginnerâ€™s Guide
 } else if (window.ActiveXObject) {
 XMLHttpRequestObjects.push(new ActiveXObject("Microsoft.XMLHTTP"));
 }
 index = XMLHttpRequestObjects.length - 1;
 if(XMLHttpRequestObjects[index]) {
 XMLHttpRequestObjects[index].open("POST", dataSource);
 var obj = document.getElementById(divID);
 XMLHttpRequestObjects[index].onreadystatechange = function()
 {
 if (XMLHttpRequestObjects[index].readyState == 4 &&
 XMLHttpRequestObjects[index].status == 200) {
 obj.innerHTML = XMLHttpRequestObjects[index].responseText;
 }
 }
 XMLHttpRequestObjects[index].send(null);
 }
 }
Finally, we tie getData1 and getData2 to the two buttons:
<html>
 <head>
 <title>Using an Array of XMLHttpRequest Objects</title>
 <script language = "javascript">
 var index = 0;
 var XMLHttpRequestObjects = new Array();
 function getData1(dataSource, divID)
 {
 if (window.XMLHttpRequest) {
 XMLHttpRequestObjects.push(new XMLHttpRequest());
 } else if (window.ActiveXObject) {
 XMLHttpRequestObjects.push(new ActiveXObject("Microsoft.XMLHTTP"));
 }
 index = XMLHttpRequestObjects.length - 1;
 if(XMLHttpRequestObjects[index]) {
 XMLHttpRequestObjects[index].open("POST", dataSource);
 var obj = document.getElementById(divID);
 XMLHttpRequestObjects[index].onreadystatechange = function()
 {
 if (XMLHttpRequestObjects[index].readyState == 4 &&
 XMLHttpRequestObjects[index].status == 200) {
 obj.innerHTML = XMLHttpRequestObjects[index].responseText;
 }
 } 
Chapter 4: Full Throttle Ajax 115
 XMLHttpRequestObjects[index].send(null);
 }
 }
 function getData2(dataSource, divID)
 {
 if (window.XMLHttpRequest) {
 XMLHttpRequestObjects.push(new XMLHttpRequest());
 } else if (window.ActiveXObject) {
 XMLHttpRequestObjects.push(new ActiveXObject("Microsoft.XMLHTTP"));
 }
 index = XMLHttpRequestObjects.length - 1;
 if(XMLHttpRequestObjects[index]) {
 XMLHttpRequestObjects[index].open("POST", dataSource);
 var obj = document.getElementById(divID);
 XMLHttpRequestObjects[index].onreadystatechange = function()
 {
 if (XMLHttpRequestObjects[index].readyState == 4 &&
 XMLHttpRequestObjects[index].status == 200) {
 obj.innerHTML = XMLHttpRequestObjects[index].responseText;
 }
 }
 XMLHttpRequestObjects[index].send(null);
 }
 }
 </script>
 </head>
 <body>
 <h1>Using an Array of XMLHttpRequest Objects</h1>
 <form>
 <input type = "button" value = "Fetch message 1"
 onclick = "getData1('dataresponder.php?data=1', 'targetDiv')">
 <input type = "button" value = "Fetch message 2"
 onclick = "getData2('dataresponder.php?data=2', 'targetDiv')">
 </form>
 <div id="targetDiv">
 <p>The fetched message will appear here.</p>
 </div>
 </body>
</html>